<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rosa Adormecida - A Surprise Awaits</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&display=swap" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
      :root {
        --curtain-dark: #1a0508;
        --curtain-red: #8b1a2c;
        --curtain-highlight: #c4324a;
        --rose-pink: #ffb6c8;
        --rose-glow: rgba(255, 182, 200, 0.6);
        --gold: #d4a853;
        --rose-900: #1a0b10;
        --rose-800: #2a0f18;
        --rose-700: #3a1623;
        --rose-500: #b63a57;
        --rose-300: #f0a7b7;
        --rose-200: #f8c6d2;
        --glow: rgba(255, 179, 198, 0.22);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Playfair Display", serif;
      }

      body {
        min-height: 100vh;
        overflow: hidden;
        background: var(--curtain-dark);
        color: #f7e7eb;
        transition: filter 0.8s ease, background 1s ease;
      }

      body.cinematic-start { filter: brightness(0.6); }
      body.brightening { filter: brightness(1.15); background: #2a0a10; }
      body.brighten { background: radial-gradient(circle at top, #3f1624 0%, #1a0b10 55%, #12070b 100%); }

      /* ========== PHASE MANAGEMENT ========== */
      .phase-intro { display: flex; }
      .phase-proposal { display: none; }
      body.show-proposal .phase-intro { display: none; }
      body.show-proposal .phase-proposal { display: block; }

      /* ========== VIGNETTE ========== */
      .vignette {
        position: fixed; inset: 0; pointer-events: none; z-index: 100;
        background: radial-gradient(ellipse at center, transparent 40%, rgba(0,0,0,0.4) 80%, rgba(0,0,0,0.7) 100%);
      }

      /* ========== HEARTBEAT GLOW ========== */
      .heartbeat-glow {
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 80vmax; height: 80vmax;
        background: radial-gradient(circle, rgba(180, 50, 70, 0.12) 0%, transparent 60%);
        pointer-events: none; z-index: 1;
        animation: heartbeatPulse 2s ease-in-out infinite;
      }

      @keyframes heartbeatPulse {
        0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(0.95); }
        15% { opacity: 0.7; transform: translate(-50%, -50%) scale(1.05); }
        30% { opacity: 0.4; transform: translate(-50%, -50%) scale(0.98); }
        45% { opacity: 0.6; transform: translate(-50%, -50%) scale(1.02); }
        60%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(0.95); }
      }

      /* ========== CURTAINS ========== */
      .curtain-container { position: fixed; inset: 0; z-index: 50; overflow: hidden; }
      .curtain {
        position: absolute; top: 0; bottom: 0; width: 52%;
        background: repeating-linear-gradient(90deg, rgba(0,0,0,0.3) 0px, rgba(0,0,0,0.1) 8px, rgba(139,26,44,0.4) 15px, rgba(0,0,0,0.2) 20px, transparent 25px, rgba(196,50,74,0.2) 35px, rgba(0,0,0,0.25) 45px),
          linear-gradient(180deg, #4a0d18 0%, #8b1a2c 15%, #6d1522 40%, #8b1a2c 60%, #5a1018 85%, #2a0508 100%);
        box-shadow: inset 0 0 100px rgba(0,0,0,0.5);
        animation: curtainSway 8s ease-in-out infinite;
      }
      .curtain-left { left: 0; transform-origin: left center; border-right: 2px solid rgba(212,168,83,0.3); }
      .curtain-right { right: 0; transform-origin: right center; border-left: 2px solid rgba(212,168,83,0.3); animation-delay: -4s; }
      
      @keyframes curtainSway {
        0%, 100% { transform: skewY(0deg) scaleX(1); }
        25% { transform: skewY(0.3deg) scaleX(1.005); }
        50% { transform: skewY(0deg) scaleX(1); }
        75% { transform: skewY(-0.3deg) scaleX(1.005); }
      }

      .curtain::before {
        content: ""; position: absolute; inset: 0;
        background: linear-gradient(90deg, transparent 10%, rgba(255,200,210,0.05) 20%, transparent 30%, rgba(255,200,210,0.03) 50%, transparent 60%, rgba(255,200,210,0.04) 80%, transparent 90%);
        animation: shimmerCurtain 12s ease-in-out infinite;
      }
      @keyframes shimmerCurtain { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

      .curtain::after {
        content: ""; position: absolute; top: 0; left: 0; right: 0; height: 120px;
        background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, transparent 100%);
      }

      .curtain-opening .curtain-left { animation: curtainOpenLeft 2.5s ease-in-out forwards; }
      .curtain-opening .curtain-right { animation: curtainOpenRight 2.5s ease-in-out forwards; }
      @keyframes curtainOpenLeft { 0% { transform: translateX(0) skewY(0); } 100% { transform: translateX(-100%) skewY(3deg); } }
      @keyframes curtainOpenRight { 0% { transform: translateX(0) skewY(0); } 100% { transform: translateX(100%) skewY(-3deg); } }

      /* ========== POETIC INTRO ========== */
      .poetic-intro {
        position: fixed; inset: 0; display: flex; flex-direction: column;
        align-items: center; justify-content: center; z-index: 55;
        pointer-events: none; opacity: 0; transition: opacity 1.5s ease;
      }
      .poetic-intro.visible { opacity: 1; }
      .poetic-intro.fade-out { opacity: 0; }
      .poetic-line {
        font-size: clamp(1.2rem, 4vw, 2rem); font-style: italic;
        color: rgba(255, 220, 230, 0.9); text-shadow: 0 0 30px rgba(255, 182, 200, 0.5);
        letter-spacing: 0.05em; opacity: 0; transform: translateY(20px);
        transition: opacity 1.2s ease, transform 1.2s ease;
      }
      .poetic-line.visible { opacity: 1; transform: translateY(0); }
      .poetic-line:nth-child(2) { margin-top: 12px; transition-delay: 0.8s; }

      /* ========== INTRO MAIN CONTENT ========== */
      .intro-content {
        position: relative; z-index: 150; display: flex; flex-direction: column;
        align-items: center; justify-content: center; min-height: 100vh;
        gap: 32px; opacity: 0; transform: translateY(30px);
        transition: opacity 1.5s ease 0.5s, transform 1.5s ease 0.5s;
      }
      .intro-content.visible { opacity: 1; transform: translateY(0); }

      .for-rosa {
        font-size: clamp(1.5rem, 5vw, 2.5rem); color: rgba(255, 240, 245, 0.95);
        letter-spacing: 0.15em; text-transform: uppercase; animation: floatText 4s ease-in-out infinite;
      }
      .for-rosa .name {
        display: inline-block;
        background: linear-gradient(90deg, var(--rose-pink), #ffd6e0, var(--rose-pink));
        background-size: 200% auto; -webkit-background-clip: text; background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: nameShimmer 3s ease-in-out infinite, floatText 4s ease-in-out infinite;
        filter: drop-shadow(0 0 12px var(--rose-glow)); position: relative;
      }
      .for-rosa .name::after {
        content: ""; position: absolute; top: 0; left: -100%; width: 50%; height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        animation: shimmerPass 4s ease-in-out infinite;
      }

      @keyframes floatText { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
      @keyframes nameShimmer {
        0%, 100% { background-position: 0% center; filter: drop-shadow(0 0 12px rgba(255,182,200,0.5)); }
        50% { background-position: 200% center; filter: drop-shadow(0 0 24px rgba(255,182,200,0.8)); }
      }
      @keyframes shimmerPass { 0% { left: -100%; opacity: 0; } 20% { opacity: 1; } 80% { opacity: 1; } 100% { left: 200%; opacity: 0; } }

      /* ========== OPEN BUTTON ========== */
      .open-btn {
        position: relative; z-index: 200; padding: 18px 48px; font-size: 1.3rem;
        font-weight: 600; letter-spacing: 0.25em; text-transform: uppercase; color: #fff;
        background: linear-gradient(135deg, #8b1a2c 0%, #c4324a 50%, #8b1a2c 100%);
        border: 2px solid rgba(255, 182, 200, 0.3); border-radius: 50px; cursor: pointer;
        overflow: hidden; animation: breathe 3s ease-in-out infinite, glowPulse 2s ease-in-out infinite;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .open-btn::before {
        content: ""; position: absolute; top: 0; left: -100%; width: 60%; height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        animation: shineSweep 3.5s ease-in-out infinite;
      }
      .open-btn:hover { transform: scale(1.08) translateY(-3px); box-shadow: 0 0 40px rgba(196,50,74,0.6), 0 15px 40px rgba(0,0,0,0.4); }
      .open-btn:active { transform: scale(1.02); }

      @keyframes breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
      @keyframes glowPulse {
        0%, 100% { box-shadow: 0 0 20px rgba(196,50,74,0.4), 0 8px 30px rgba(0,0,0,0.3); }
        50% { box-shadow: 0 0 40px rgba(196,50,74,0.7), 0 0 60px rgba(255,100,130,0.3), 0 8px 30px rgba(0,0,0,0.3); }
      }
      @keyframes shineSweep { 0% { left: -100%; } 50%, 100% { left: 200%; } }

      .microcopy {
        font-size: 0.95rem; font-style: italic; color: rgba(255, 210, 220, 0.7);
        letter-spacing: 0.05em; text-shadow: 0 0 20px rgba(255, 182, 200, 0.3);
        animation: fadeInUp 1.5s ease 1s both;
      }
      @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

      /* ========== PETAL ANIMATIONS ========== */
      .petal-container { position: fixed; inset: 0; pointer-events: none; z-index: 60; overflow: hidden; }
      .petal {
        position: absolute; width: 20px; height: 28px;
        background: radial-gradient(circle at 30% 30%, #ffb6c8, #c94a66);
        border-radius: 60% 40% 60% 40%; opacity: 0;
      }
      .petal.burst { animation: petalBurst 3s ease-out forwards; }
      @keyframes petalBurst {
        0% { opacity: 0; transform: translate(0, 0) rotate(0deg) scale(0.5); }
        10% { opacity: 1; }
        100% { opacity: 0; transform: translate(var(--tx), var(--ty)) rotate(720deg) scale(1); }
      }

      .ambient-petal {
        position: fixed; width: 14px; height: 20px;
        background: radial-gradient(circle at 30% 30%, rgba(255,182,200,0.6), rgba(180,60,80,0.4));
        border-radius: 60% 40% 60% 40%; pointer-events: none; z-index: 15;
        animation: floatPetal linear infinite;
      }
      @keyframes floatPetal {
        0% { transform: translateY(-20px) rotate(0deg) translateX(0); opacity: 0; }
        10% { opacity: 0.7; }
        90% { opacity: 0.7; }
        100% { transform: translateY(110vh) rotate(360deg) translateX(30px); opacity: 0; }
      }

      .petal:nth-child(3n) { background: radial-gradient(circle at 30% 30%, #ffb8c9, #c94a66); }
      .petal:nth-child(5n) { background: radial-gradient(circle at 30% 30%, #e896a8, #8a2238); }

      audio { display: none; }

      /* ========== PROPOSAL PHASE STYLES ========== */
      .gradient-overlay { background: linear-gradient(120deg, rgba(182,58,87,0.12), rgba(24,8,13,0.9)); pointer-events: none; position: absolute; inset: 0; }
      .soft-glow { text-shadow: 0 0 12px rgba(255, 196, 210, 0.35); }

      .cinematic-text { opacity: 0; transform: scale(0.95); transition: opacity 1.5s ease, transform 1.5s ease; }
      .cinematic-text.visible { opacity: 1; transform: scale(1); }

      .fade-in { opacity: 0; transform: scale(0.95); animation: cinematicFadeIn 1.5s ease forwards; }
      .fade-delay-1 { animation-delay: 0.5s; }
      .fade-delay-2 { animation-delay: 4s; }
      .fade-delay-3 { animation-delay: 7.5s; }
      @keyframes cinematicFadeIn { 0% { opacity: 0; transform: scale(0.95); } 100% { opacity: 1; transform: scale(1); } }

      .name-glow {
        display: inline; background: linear-gradient(90deg, #f8c6d2, #ffb6c8, #f8c6d2);
        background-size: 200% auto; -webkit-background-clip: text; background-clip: text;
        -webkit-text-fill-color: transparent; animation: nameShimmer 3s ease-in-out infinite;
        filter: drop-shadow(0 0 8px rgba(255, 182, 200, 0.5));
      }

      .yes-pulse { animation: yesPulse 2.8s ease-in-out infinite; box-shadow: 0 0 20px rgba(182, 58, 87, 0.4); }
      .yes-pulse.clicked { animation: none; }
      @keyframes yesPulse {
        0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(182, 58, 87, 0.4); }
        50% { transform: scale(1.05); box-shadow: 0 0 35px rgba(182, 58, 87, 0.6); }
      }

      .success-line { opacity: 0; transform: scale(0.95) translateY(10px); transition: opacity 0.8s ease, transform 0.8s ease; }
      .success-line.revealed { opacity: 1; transform: scale(1) translateY(0); }

      .voice-player-hidden { opacity: 0; transform: translateY(15px); pointer-events: none; }
      .voice-player-visible { opacity: 1; transform: translateY(0); pointer-events: auto; transition: opacity 1s ease, transform 1s ease; }

      .typewriter::after { content: "|"; margin-left: 4px; animation: blink 1s step-end infinite; }
      @keyframes blink { 50% { opacity: 0; } }

      .scene { animation: slowZoom 18s ease-in-out infinite alternate; }
      @keyframes slowZoom { 0% { transform: scale(1); } 100% { transform: scale(1.04); } }

      .proposal-overlay {
        position: fixed; inset: 0; z-index: 80; display: flex; align-items: center;
        justify-content: center; padding: 24px; background: rgba(8, 4, 7, 0.76);
        backdrop-filter: blur(8px); opacity: 0; pointer-events: none; transition: opacity 1.1s ease;
      }
      .proposal-wrapper { position: relative; }
      .proposal-wrapper::before {
        content: ""; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 120%; height: 120%; background: radial-gradient(circle at center, rgba(255,100,120,0.15), transparent 70%);
        pointer-events: none; z-index: -1; animation: warmGlowPulse 4s ease-in-out infinite;
      }
      @keyframes warmGlowPulse { 0%, 100% { opacity: 0.7; transform: translate(-50%, -50%) scale(1); } 50% { opacity: 1; transform: translate(-50%, -50%) scale(1.05); } }

      .proposal-window {
        width: min(720px, 92vw); border-radius: 28px; border: 1px solid rgba(248, 198, 210, 0.18);
        background: linear-gradient(150deg, rgba(18, 7, 11, 0.96), rgba(46, 14, 22, 0.92));
        box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6); overflow: hidden; opacity: 0;
        transform: translateY(24px) scale(0.98);
      }
      .proposal-card { position: relative; padding: 36px 40px 42px; text-align: center; overflow: hidden; }
      .light-sweep {
        position: absolute; inset: 0;
        background: linear-gradient(120deg, rgba(255,255,255,0) 0%, rgba(255,236,242,0.18) 50%, rgba(255,255,255,0) 100%);
        transform: translateX(-140%); animation: lightSweep 6s ease-in-out infinite; pointer-events: none; z-index: 0;
      }
      @keyframes lightSweep { 0% { transform: translateX(-140%); opacity: 0; } 30% { opacity: 0.6; } 100% { transform: translateX(140%); opacity: 0; } }
      .proposal-card > :not(.light-sweep) { position: relative; z-index: 1; }

      .proposal-open .proposal-overlay { opacity: 1; pointer-events: auto; }
      .proposal-open .proposal-window { animation: proposalReveal 1.4s ease forwards; }
      @keyframes proposalReveal { 0% { opacity: 0; transform: translateY(24px) scale(0.98); } 100% { opacity: 1; transform: translateY(0) scale(1); } }

      .success-overlay {
        position: fixed; inset: 0; display: flex; align-items: center; justify-content: center;
        background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(8px); opacity: 0;
        pointer-events: none; transition: opacity 1.1s ease; z-index: 90;
      }
      .success-wrapper { position: relative; }
      .success-wrapper::before {
        content: ""; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 130%; height: 130%; background: radial-gradient(circle at center, rgba(255,100,120,0.18), transparent 65%);
        pointer-events: none; z-index: -1;
      }
      .success-window {
        width: min(600px, 90vw); border-radius: 28px; border: 1px solid rgba(248, 198, 210, 0.25);
        background: linear-gradient(150deg, rgba(42, 15, 24, 0.98), rgba(60, 20, 32, 0.95));
        box-shadow: 0 30px 80px rgba(0, 0, 0, 0.7); padding: 48px 40px; text-align: center;
        opacity: 0; transform: translateY(24px) scale(0.98);
      }
      .success-open .success-overlay { opacity: 1; pointer-events: auto; }
      .success-open .success-window { animation: proposalReveal 1.4s ease forwards; }

      .custom-audio-player {
        display: flex; align-items: center; justify-content: center; gap: 12px;
        background: rgba(255, 196, 210, 0.08); border: 1px solid rgba(248, 198, 210, 0.2);
        border-radius: 50px; padding: 12px 16px; max-width: 320px; margin: 0 auto;
      }
      .play-btn {
        display: flex; align-items: center; justify-content: center; width: 40px; height: 40px;
        background: linear-gradient(135deg, #b63a57, #d4546f); border: none; border-radius: 50%;
        cursor: pointer; color: white; font-size: 18px; transition: transform 0.2s ease, box-shadow 0.2s ease; flex-shrink: 0;
      }
      .play-btn:hover { transform: scale(1.08); box-shadow: 0 0 20px rgba(182, 58, 87, 0.4); }
      .play-btn:active { transform: scale(0.95); }
      .audio-progress-container { flex: 1; display: flex; align-items: center; gap: 8px; }
      .time-label { font-size: 12px; color: rgba(255, 196, 210, 0.7); min-width: 32px; text-align: center; font-weight: 500; }
      .progress-bar { flex: 1; height: 4px; background: rgba(255, 196, 210, 0.2); border-radius: 2px; cursor: pointer; position: relative; overflow: hidden; }
      .progress-fill { height: 100%; background: linear-gradient(90deg, #b63a57, #f0a7b7); border-radius: 2px; width: 0%; transition: width 0.1s linear; }

      .move-away { transition: transform 0.2s ease; }
      .hidden { opacity: 0; pointer-events: none; }

      @media (max-width: 640px) {
        .petal { width: 12px; height: 18px; }
        .proposal-card { padding: 28px 24px 32px; }
      }
    </style>
  </head>
  <body class="cinematic-start">
    <!-- PHASE 1: INTRO -->
    <div class="phase-intro">
      <div class="vignette"></div>
      <div class="heartbeat-glow"></div>
      <div class="curtain-container" id="curtain-container">
        <div class="curtain curtain-left"></div>
        <div class="curtain curtain-right"></div>
      </div>
      <div class="poetic-intro" id="poetic-intro">
        <p class="poetic-line">Some surprises are not opened...</p>
        <p class="poetic-line">They are felt.</p>
      </div>
      <div class="intro-content" id="intro-content">
        <h1 class="for-rosa">For <span class="name">Rosa</span>...</h1>
        <button class="open-btn" id="open-btn">Open</button>
        <p class="microcopy">Tap gently... if your heart is ready.</p>
      </div>
      <div class="petal-container" id="petal-container"></div>
    </div>

    <!-- PHASE 2: PROPOSAL -->
    <div class="phase-proposal">
      <div class="gradient-overlay"></div>
      <div class="heartbeat-glow"></div>
      <div class="absolute inset-0 overflow-hidden pointer-events-none" id="petal-layer"></div>

      <main class="scene relative z-10 flex min-h-screen items-center justify-center px-6">
        <div class="max-w-2xl text-center space-y-6">
          <div id="intro-1" class="fade-in fade-delay-1 text-2xl sm:text-3xl soft-glow">
            Some roses bloom quietly... unnoticed by the world.
          </div>
          <div id="intro-2" class="fade-in fade-delay-2 text-2xl sm:text-3xl soft-glow">
            But some roses don't just bloom... they change the air around them
          </div>
          <div id="typewriter" class="fade-in fade-delay-3 text-xl sm:text-2xl text-rose-200 typewriter"></div>
        </div>
      </main>

      <div id="proposal-overlay" class="proposal-overlay">
        <div class="proposal-wrapper">
          <div class="proposal-window">
            <div class="proposal-card">
              <div class="light-sweep"></div>
              <p class="text-sm sm:text-base uppercase tracking-[0.35em] text-rose-200/70 cinematic-text">A moment held just for you</p>
              <h1 class="mt-4 text-3xl sm:text-4xl font-semibold soft-glow cinematic-text">
                Will you be my Valentine, <span class="name-glow">ADETEJU</span>?
              </h1>
              <p class="mt-4 text-base sm:text-lg text-rose-200/90 cinematic-text">
                Somewhere between your laughter and your quiet momentsâ€¦ something in me shifted.
                And today feels like the right day to stop pretending it didn't.
              </p>
              <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-4 cinematic-text">
                <button id="yes-btn" class="yes-pulse rounded-full bg-rose-500 px-8 py-3 text-lg font-semibold text-white shadow-lg transition">YES ðŸ¥°</button>
                <button id="no-btn" class="move-away rounded-full border border-rose-200/40 px-8 py-3 text-lg text-rose-100 shadow-lg">NO ðŸ˜¢</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="success-overlay" class="success-overlay">
        <div class="success-wrapper">
          <div class="success-window">
            <p class="text-sm uppercase tracking-[0.35em] text-rose-300/70 mb-4 success-line">You just made this moment unforgettable.</p>
            <h1 class="text-3xl sm:text-4xl font-semibold soft-glow text-rose-200 mb-6 success-line">Yes! ðŸ’•</h1>
            <div class="text-lg text-rose-200/90 soft-glow mb-8">
              <p class="success-line"><span class="name-glow">Adeteju</span>...</p>
              <p class="success-line mt-2">I don't know exactly when it happened... but somewhere along the way, you became my favorite notification, my calm in busy days, and the smile I look for without trying.</p>
              <p class="success-line mt-3">Thank you for choosing this moment with me.</p>
              <p class="success-line mt-3">I promise to make this Valentine feel as warm as the way you make me feel ðŸ’•</p>
            </div>
            <div id="voice-message-window" class="mt-6 voice-player-hidden">
              <audio id="voice-audio"><source src="voice-message.mp3" type="audio/mpeg" /></audio>
              <div class="custom-audio-player">
                <button class="play-btn" id="play-btn">â–¶</button>
                <div class="audio-progress-container">
                  <span class="time-label" id="current-time">0:00</span>
                  <div class="progress-bar" id="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
                  <span class="time-label" id="duration">0:00</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Audio -->
    <audio id="heartbeat-audio" loop preload="auto">
      <source src="https://assets.mixkit.co/sfx/preview/mixkit-single-heartbeat-580.mp3" type="audio/mpeg">
    </audio>
    <audio id="curtain-sound" preload="auto">
      <source src="https://assets.mixkit.co/sfx/preview/mixkit-fabric-swoosh-1486.mp3" type="audio/mpeg">
    </audio>
    <audio id="bg-music" preload="auto" loop>
      <source src="love-bg.mp3" type="audio/mpeg" />
    </audio>

    <script>
      // ========== ELEMENTS ==========
      const body = document.body;
      const poeticIntro = document.getElementById("poetic-intro");
      const poeticLines = document.querySelectorAll(".poetic-line");
      const introContent = document.getElementById("intro-content");
      const openBtn = document.getElementById("open-btn");
      const curtainContainer = document.getElementById("curtain-container");
      const petalContainer = document.getElementById("petal-container");
      const heartbeatAudio = document.getElementById("heartbeat-audio");
      const curtainSound = document.getElementById("curtain-sound");
      const bgMusic = document.getElementById("bg-music");

      heartbeatAudio.volume = 0.15;
      curtainSound.volume = 0.4;
      bgMusic.volume = 0;

      // ========== AMBIENT PETALS ==========
      const createAmbientPetal = () => {
        const petal = document.createElement("div");
        petal.className = "ambient-petal";
        const size = 10 + Math.random() * 12;
        petal.style.width = `${size}px`;
        petal.style.height = `${size * 1.4}px`;
        petal.style.left = `${Math.random() * 100}%`;
        petal.style.animationDuration = `${12 + Math.random() * 8}s`;
        petal.style.animationDelay = `${Math.random() * 5}s`;
        petal.style.opacity = 0.3 + Math.random() * 0.4;
        petal.style.filter = `blur(${Math.random() * 1.5}px)`;
        body.appendChild(petal);
        setTimeout(() => petal.remove(), 25000);
      };
      for (let i = 0; i < 8; i++) setTimeout(() => createAmbientPetal(), i * 400);
      setInterval(createAmbientPetal, 2000);

      // ========== CINEMATIC INTRO SEQUENCE ==========
      const startCinematicSequence = async () => {
        try { await heartbeatAudio.play(); } catch (e) {
          const startAudio = () => { heartbeatAudio.play(); document.removeEventListener("click", startAudio); };
          document.addEventListener("click", startAudio, { once: true });
        }
        setTimeout(() => body.classList.remove("cinematic-start"), 500);
        setTimeout(() => { poeticIntro.classList.add("visible"); poeticLines.forEach(l => l.classList.add("visible")); }, 1000);
        setTimeout(() => poeticIntro.classList.add("fade-out"), 4000);
        setTimeout(() => introContent.classList.add("visible"), 5000);
      };
      startCinematicSequence();

      // ========== PETAL BURST ==========
      const createPetalBurst = (x, y, count = 25) => {
        for (let i = 0; i < count; i++) {
          const petal = document.createElement("div");
          petal.className = "petal burst";
          const size = 12 + Math.random() * 18;
          petal.style.width = `${size}px`;
          petal.style.height = `${size * 1.4}px`;
          petal.style.left = `${x}px`;
          petal.style.top = `${y}px`;
          const angle = Math.random() * Math.PI * 2;
          const distance = 150 + Math.random() * 250;
          petal.style.setProperty("--tx", `${Math.cos(angle) * distance}px`);
          petal.style.setProperty("--ty", `${Math.sin(angle) * distance - 100}px`);
          petal.style.animationDelay = `${Math.random() * 0.3}s`;
          const hue = 340 + Math.random() * 30;
          petal.style.background = `radial-gradient(circle at 30% 30%, hsl(${hue}, 80%, 80%), hsl(${hue}, 60%, 50%))`;
          petalContainer.appendChild(petal);
          setTimeout(() => petal.remove(), 3500);
        }
      };

      // ========== OPEN BUTTON CLICK ==========
      let isClicked = false;
      openBtn.addEventListener("click", function(e) {
        e.preventDefault();
        if (isClicked) return;
        isClicked = true;

        try { curtainSound.currentTime = 0; curtainSound.play().catch(() => {}); } catch (err) {}
        try { heartbeatAudio.playbackRate = 1.3; } catch (err) {}

        const rect = openBtn.getBoundingClientRect();
        createPetalBurst(rect.left + rect.width / 2, rect.top + rect.height / 2, 30);
        curtainContainer.classList.add("curtain-opening");

        setTimeout(() => body.classList.add("brightening"), 800);
        setTimeout(() => { introContent.style.opacity = "0"; introContent.style.transform = "scale(1.1)"; }, 1200);
        setTimeout(() => createPetalBurst(window.innerWidth / 2, window.innerHeight / 2, 40), 1500);

        setTimeout(() => {
          // Fade out heartbeat, start bg music
          const fadeOut = setInterval(() => {
            if (heartbeatAudio.volume > 0.02) heartbeatAudio.volume -= 0.02;
            else { clearInterval(fadeOut); heartbeatAudio.pause(); }
          }, 50);
          
          // Show proposal phase
          body.classList.add("show-proposal");
          body.classList.remove("brightening");
          bgMusic.play().catch(() => {});
          let vol = 0;
          const fadeIn = setInterval(() => { vol = Math.min(vol + 0.05, 0.4); bgMusic.volume = vol; if (vol >= 0.4) clearInterval(fadeIn); }, 200);
          
          // Start proposal sequence
          startProposalSequence();
        }, 2800);
      });

      // ========== PROPOSAL PHASE ==========
      const typewriterText = "Today, being Lovers' Dayâ€¦ I found myself thinking of one rose in particular â€” the kind that blooms quietly, yet changes the air around it.";
      const typewriterEl = document.getElementById("typewriter");
      let typeIndex = 0;

      const typewriter = () => {
        if (typeIndex < typewriterText.length) {
          typewriterEl.textContent += typewriterText.charAt(typeIndex);
          typeIndex++;
          setTimeout(typewriter, 45);
        } else {
          typewriterEl.classList.remove("typewriter");
          setTimeout(() => body.classList.add("proposal-open"), 2200);
        }
      };

      const startProposalSequence = () => {
        // Create petals for proposal phase
        const petalLayer = document.getElementById("petal-layer");
        const createProposalPetal = () => {
          const petal = document.createElement("span");
          petal.className = "petal";
          const depth = Math.random();
          const size = 8 + depth * 16 + Math.random() * 6;
          petal.style.width = `${size}px`;
          petal.style.height = `${size * 1.5}px`;
          petal.style.left = `${Math.random() * 100}%`;
          const duration = 14 + (1 - depth) * 12 + Math.random() * 6;
          petal.style.animationDuration = `${duration}s`;
          petal.style.animationDelay = `${Math.random() * 4}s`;
          petal.style.setProperty('--petal-opacity', 0.25 + depth * 0.55);
          petal.style.filter = `blur(${(1 - depth) * 2.5}px)`;
          petal.style.zIndex = Math.floor(depth * 10);
          petal.style.animationName = "floatPetal";
          petal.style.animationTimingFunction = "ease-in-out";
          petalLayer.appendChild(petal);
          setTimeout(() => petal.remove(), (duration + 4) * 1000);
        };
        for (let i = 0; i < 22; i++) setTimeout(() => createProposalPetal(), i * 200);
        setInterval(createProposalPetal, 1200);

        setTimeout(typewriter, 6200);
      };

      // ========== PROPOSAL OPEN OBSERVER ==========
      const observeProposal = new MutationObserver((mutations) => {
        mutations.forEach((m) => {
          if (m.target.classList.contains("proposal-open")) {
            document.querySelectorAll(".proposal-card .cinematic-text").forEach((el, i) => {
              setTimeout(() => el.classList.add("visible"), 300 * (i + 1));
            });
          }
        });
      });
      observeProposal.observe(body, { attributes: true, attributeFilter: ["class"] });

      // ========== YES/NO BUTTONS ==========
      const yesBtn = document.getElementById("yes-btn");
      const noBtn = document.getElementById("no-btn");

      yesBtn.addEventListener("click", () => {
        yesBtn.classList.add("clicked");
        noBtn.style.display = "none";
        setTimeout(() => {
          body.classList.add("brighten");
          setTimeout(() => {
            confetti({ particleCount: 160, spread: 90, origin: { y: 0.6 }, colors: ["#f8c6d2", "#b63a57", "#f0a7b7", "#ffffff", "#ff9eb5"] });
            body.classList.add("success-open");
            body.classList.remove("proposal-open");
            document.querySelectorAll(".success-line").forEach((line, i) => {
              setTimeout(() => line.classList.add("revealed"), 600 * (i + 1));
            });
            const voicePlayer = document.getElementById("voice-message-window");
            setTimeout(() => { voicePlayer.classList.remove("voice-player-hidden"); voicePlayer.classList.add("voice-player-visible"); }, 600 * 7);
          }, 300);
        }, 500);
      });

      let noBtnMoved = false;
      const moveNoButton = () => {
        if (!noBtnMoved) { document.body.appendChild(noBtn); noBtnMoved = true; }
        const padding = 50, btnW = noBtn.offsetWidth || 120, btnH = noBtn.offsetHeight || 50;
        const maxX = window.innerWidth - btnW - padding, maxY = window.innerHeight - btnH - padding;
        noBtn.style.position = "fixed";
        noBtn.style.left = `${padding + Math.random() * Math.max(maxX - padding, 100)}px`;
        noBtn.style.top = `${padding + Math.random() * Math.max(maxY - padding, 100)}px`;
        noBtn.style.zIndex = "9999";
        noBtn.style.transition = "left 0.25s ease-out, top 0.25s ease-out";
        noBtn.style.margin = "0";
      };
      noBtn.addEventListener("mouseenter", moveNoButton);
      noBtn.addEventListener("touchstart", (e) => { e.preventDefault(); moveNoButton(); });
      noBtn.addEventListener("click", (e) => { e.preventDefault(); moveNoButton(); });

      // ========== VOICE AUDIO PLAYER ==========
      const voiceAudio = document.getElementById("voice-audio");
      const playBtn = document.getElementById("play-btn");
      const progressBar = document.getElementById("progress-bar");
      const progressFill = document.getElementById("progress-fill");
      const currentTimeEl = document.getElementById("current-time");
      const durationEl = document.getElementById("duration");

      const formatTime = (s) => { if (!s || isNaN(s)) return "0:00"; return `${Math.floor(s/60)}:${Math.floor(s%60).toString().padStart(2,"0")}`; };
      playBtn.addEventListener("click", () => { if (voiceAudio.paused) { voiceAudio.play(); playBtn.textContent = "â¸"; } else { voiceAudio.pause(); playBtn.textContent = "â–¶"; } });
      voiceAudio.addEventListener("play", () => playBtn.textContent = "â¸");
      voiceAudio.addEventListener("pause", () => playBtn.textContent = "â–¶");
      voiceAudio.addEventListener("loadedmetadata", () => durationEl.textContent = formatTime(voiceAudio.duration));
      voiceAudio.addEventListener("timeupdate", () => { progressFill.style.width = (voiceAudio.currentTime / voiceAudio.duration) * 100 + "%"; currentTimeEl.textContent = formatTime(voiceAudio.currentTime); });
      progressBar.addEventListener("click", (e) => { const rect = progressBar.getBoundingClientRect(); voiceAudio.currentTime = ((e.clientX - rect.left) / rect.width) * voiceAudio.duration; });
      voiceAudio.addEventListener("ended", () => playBtn.textContent = "â–¶");
    </script>
  </body>
</html>
